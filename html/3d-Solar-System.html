<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syst√®me Solaire 3D - Three.js</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000;
            color: white;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
        }

        #container {
            position: relative;
            width: 100vw;
            height: 100vh;
        }

        canvas {
            display: block;
            outline: none;
        }

        #ui {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid rgba(100, 150, 255, 0.3);
            max-width: 600px;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        #ui h1 {
            color: #4fc3f7;
            margin-bottom: 15px;
            font-size: 24px;
        }

        #planetInfo {
            line-height: 1.6;
            font-size: 14px;
        }

        .highlight {
            color: #ffcc80;
            font-weight: bold;
        }

        .controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 15px 25px;
            border-radius: 10px;
            border: 1px solid rgba(100, 150, 255, 0.3);
            z-index: 100;
            display: flex;
            gap: 30px;
            align-items: center;
            backdrop-filter: blur(10px);
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control-group label {
            font-size: 14px;
            color: #4fc3f7;
            min-width: 80px;
        }

        .control-group input {
            width: 120px;
        }

        .value-display {
            min-width: 40px;
            text-align: center;
            font-weight: bold;
            color: #ffcc80;
        }

        #instructions {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            color: #aaa;
            font-style: italic;
            text-align: center;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 5px;
            z-index: 100;
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #4fc3f7;
            font-size: 18px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div id="container">
        <div class="loading" id="loading">Chargement du syst√®me solaire...</div>
        
        <div id="ui">
            <h1>üåü Syst√®me Solaire 3D</h1>
            <div id="planetInfo">
                <p><span class="highlight">Instructions:</span></p>
                <p>‚Ä¢ Clic gauche + d√©placer : Rotation autour de la sc√®ne</p>
                <p>‚Ä¢ Molette : Zoom avant/arri√®re</p>
                <p>‚Ä¢ Clic droit + d√©placer : D√©placer la cam√©ra (changer le point de vue)</p>
                <p>‚Ä¢ Cliquez sur une plan√®te ou lune pour les infos</p>
            </div>
        </div>

        <div class="controls">
            <div class="control-group">
                <label for="speed-slider">Vitesse:</label>
                <input type="range" id="speed-slider" min="0" max="3" step="0.1" value="1">
                <span class="value-display" id="speed-value">1x</span>
            </div>
            <div class="control-group">
                <label for="scale-slider">Taille:</label>
                <input type="range" id="scale-slider" min="0.5" max="2" step="0.1" value="1">
                <span class="value-display" id="scale-value">1x</span>
            </div>
        </div>

        <div id="instructions">
            Explorez notre syst√®me solaire en 3D ! Utilisez le clic droit pour changer votre point de vue.
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <script>
        // OrbitControls am√©lior√© avec navigation compl√®te
        class OrbitControls {
            constructor(object, domElement) {
                this.object = object;
                this.domElement = domElement;

                // Configuration
                this.enableDamping = true;
                this.dampingFactor = 0.05;
                this.screenSpacePanning = true; // Permet le d√©placement libre
                this.minDistance = 5;
                this.maxDistance = 200;
                this.maxPolarAngle = Math.PI;

                // √âtat
                this.target = new THREE.Vector3(0, 0, 0);
                this.spherical = new THREE.Spherical();
                this.sphericalDelta = new THREE.Spherical();
                this.scale = 1;
                this.panOffset = new THREE.Vector3();
                
                // √âtats de la souris
                this.isMouseDown = false;
                this.mouseButton = null;
                this.rotateStart = new THREE.Vector2();
                this.rotateEnd = new THREE.Vector2();
                this.rotateDelta = new THREE.Vector2();
                this.panStart = new THREE.Vector2();
                this.panEnd = new THREE.Vector2();
                this.panDelta = new THREE.Vector2();

                // Vectors temporaires
                this.v = new THREE.Vector3();

                this.updateSpherical();

                // √âv√©nements
                this.handleMouseDown = this.handleMouseDown.bind(this);
                this.handleMouseMove = this.handleMouseMove.bind(this);
                this.handleMouseUp = this.handleMouseUp.bind(this);
                this.handleWheel = this.handleWheel.bind(this);
                this.handleContextMenu = this.handleContextMenu.bind(this);

                this.connect();
            }

            connect() {
                this.domElement.addEventListener('mousedown', this.handleMouseDown);
                this.domElement.addEventListener('wheel', this.handleWheel);
                this.domElement.addEventListener('contextmenu', this.handleContextMenu);
                document.addEventListener('mousemove', this.handleMouseMove);
                document.addEventListener('mouseup', this.handleMouseUp);
            }

            updateSpherical() {
                this.v.subVectors(this.object.position, this.target);
                this.spherical.setFromVector3(this.v);
            }

            handleMouseDown(event) {
                event.preventDefault();

                this.isMouseDown = true;
                this.mouseButton = event.button;

                if (event.button === 0) {
                    // Clic gauche - rotation
                    this.rotateStart.set(event.clientX, event.clientY);
                } else if (event.button === 2) {
                    // Clic droit - pan/d√©placement
                    this.panStart.set(event.clientX, event.clientY);
                }

                this.domElement.style.cursor = 'grabbing';
            }

            handleMouseMove(event) {
                if (!this.isMouseDown) return;

                if (this.mouseButton === 0) {
                    // Rotation avec clic gauche
                    this.rotateEnd.set(event.clientX, event.clientY);
                    this.rotateDelta.subVectors(this.rotateEnd, this.rotateStart);
                    
                    this.rotateLeft(6 * Math.PI * this.rotateDelta.x / this.domElement.clientHeight);
                    this.rotateUp(6 * Math.PI * this.rotateDelta.y / this.domElement.clientHeight);
                    
                    this.rotateStart.copy(this.rotateEnd);
                } else if (this.mouseButton === 2) {
                    // Pan/d√©placement avec clic droit
                    this.panEnd.set(event.clientX, event.clientY);
                    this.panDelta.subVectors(this.panEnd, this.panStart);
                    
                    this.pan(this.panDelta.x, this.panDelta.y);
                    
                    this.panStart.copy(this.panEnd);
                }
            }

            handleMouseUp() {
                this.isMouseDown = false;
                this.mouseButton = null;
                this.domElement.style.cursor = 'grab';
            }

            handleWheel(event) {
                event.preventDefault();
                
                if (event.deltaY < 0) {
                    this.scale /= 1.1;
                } else {
                    this.scale *= 1.1;
                }
                
                // Limiter le zoom
                this.spherical.radius *= this.scale;
                this.spherical.radius = Math.max(this.minDistance, Math.min(this.maxDistance, this.spherical.radius));
                this.scale = 1;
            }

            handleContextMenu(event) {
                event.preventDefault();
            }

            rotateLeft(angle) {
                this.sphericalDelta.theta -= angle;
            }

            rotateUp(angle) {
                this.sphericalDelta.phi -= angle;
            }

            pan(deltaX, deltaY) {
                // Calculer le d√©placement en fonction de la distance de la cam√©ra
                const offset = new THREE.Vector3();
                offset.copy(this.object.position).sub(this.target);
                const targetDistance = offset.length();

                // Convertir le d√©placement de pixels en unit√©s 3D
                const panX = deltaX * targetDistance / 800;
                const panY = deltaY * targetDistance / 800;

                // D√©placer la cible et la position de la cam√©ra
                this.panLeft(panX);
                this.panUp(panY);
            }

            panLeft(distance) {
                this.v.setFromMatrixColumn(this.object.matrix, 0);
                this.v.multiplyScalar(-distance);
                this.panOffset.add(this.v);
            }

            panUp(distance) {
                this.v.setFromMatrixColumn(this.object.matrix, 1);
                this.v.multiplyScalar(distance);
                this.panOffset.add(this.v);
            }

            update() {
                // Appliquer le damping
                if (this.enableDamping) {
                    this.spherical.theta += this.sphericalDelta.theta * this.dampingFactor;
                    this.spherical.phi += this.sphericalDelta.phi * this.dampingFactor;
                    
                    // R√©duire progressivement le delta
                    this.sphericalDelta.theta *= (1 - this.dampingFactor);
                    this.sphericalDelta.phi *= (1 - this.dampingFactor);
                } else {
                    this.spherical.theta += this.sphericalDelta.theta;
                    this.spherical.phi += this.sphericalDelta.phi;
                }

                // Limiter l'angle phi
                this.spherical.phi = Math.max(0.1, Math.min(Math.PI - 0.1, this.spherical.phi));

                // Appliquer le pan
                this.target.add(this.panOffset);
                
                // Mettre √† jour la position de la cam√©ra
                this.v.setFromSpherical(this.spherical);
                this.object.position.copy(this.target).add(this.v);
                
                // Orienter la cam√©ra vers la cible
                this.object.lookAt(this.target);

                // R√©initialiser les deltas
                this.sphericalDelta.set(0, 0, 0);
                this.panOffset.set(0, 0, 0);
            }
        }

        // Classe principale du syst√®me solaire
        class SolarSystem {
            constructor() {
                this.scene = null;
                this.camera = null;
                this.renderer = null;
                this.controls = null;
                this.raycaster = null;
                this.mouse = null;
                
                this.planets = new Map();
                this.planetGroups = new Map();
                this.animationSpeed = 1;
                this.scaleFactor = 1;
                
                this.selectedPlanet = null;
                
                this.init();
            }

            init() {
                this.createScene();
                this.createCamera();
                this.createRenderer();
                this.createControls();
                this.createLights();
                this.createSolarSystem();
                this.createStars();
                this.setupEventListeners();
                
                this.hideLoading();
                this.animate();
            }

            createScene() {
                this.scene = new THREE.Scene();
                this.scene.background = new THREE.Color(0x001a33);
                this.scene.fog = new THREE.Fog(0x001a33, 50, 300);
            }

            createCamera() {
                this.camera = new THREE.PerspectiveCamera(
                    60, 
                    window.innerWidth / window.innerHeight, 
                    0.1, 
                    1000
                );
                this.camera.position.set(0, 20, 50);
            }

            createRenderer() {
                this.renderer = new THREE.WebGLRenderer({ 
                    antialias: true
                });
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                this.renderer.shadowMap.enabled = true;
                this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;
                
                document.getElementById('container').appendChild(this.renderer.domElement);
            }

            createControls() {
                this.controls = new OrbitControls(this.camera, this.renderer.domElement);
            }

            createLights() {
                // Lumi√®re principale (soleil)
                const sunLight = new THREE.PointLight(0xffffff, 1.5, 200);
                sunLight.position.set(0, 0, 0);
                this.scene.add(sunLight);

                // Lumi√®re ambiante
                const ambientLight = new THREE.AmbientLight(0x333333, 0.4);
                this.scene.add(ambientLight);

                // Lumi√®re directionnelle suppl√©mentaire
                const directionalLight = new THREE.DirectionalLight(0xffffff, 0.3);
                directionalLight.position.set(10, 10, 5);
                this.scene.add(directionalLight);
            }

            createSolarSystem() {
                // Configuration des plan√®tes
                const planetsConfig = [
                    { name: 'sun', radius: 3, color: 0xff4500, distance: 0, rotationSpeed: 0.001, revolutionSpeed: 0, emissive: true },
                    { name: 'mercury', radius: 0.4, color: 0x8c8c8c, distance: 8, rotationSpeed: 0.008, revolutionSpeed: 0.04 },
                    { name: 'venus', radius: 0.6, color: 0xe6b87e, distance: 11, rotationSpeed: 0.006, revolutionSpeed: 0.015 },
                    { name: 'earth', radius: 0.7, color: 0x1e90ff, distance: 14, rotationSpeed: 0.01, revolutionSpeed: 0.01 },
                    { name: 'mars', radius: 0.5, color: 0xc1440e, distance: 17, rotationSpeed: 0.009, revolutionSpeed: 0.005 },
                    { name: 'jupiter', radius: 1.5, color: 0xc19b6c, distance: 22, rotationSpeed: 0.02, revolutionSpeed: 0.001 },
                    { name: 'saturn', radius: 1.3, color: 0xe3cda5, distance: 28, rotationSpeed: 0.018, revolutionSpeed: 0.0007 },
                    { name: 'uranus', radius: 1.0, color: 0x4fd0e7, distance: 34, rotationSpeed: 0.015, revolutionSpeed: 0.0004 },
                    { name: 'neptune', radius: 1.0, color: 0x4b70dd, distance: 40, rotationSpeed: 0.015, revolutionSpeed: 0.0002 }
                ];

                planetsConfig.forEach(config => {
                    this.createPlanet(config);
                });

                // Ajouter toutes les lunes
                this.createMoon(this.planets.get('earth'), 0.15, 1.2, 0xcccccc, 'moon');
                this.createMoon(this.planets.get('mars'), 0.08, 1.0, 0x888888, 'phobos');
                this.createMoon(this.planets.get('mars'), 0.06, 1.5, 0x666666, 'deimos');
                this.createMoon(this.planets.get('jupiter'), 0.12, 2.0, 0xff6b6b, 'io');
                this.createMoon(this.planets.get('jupiter'), 0.10, 2.5, 0x4ecdc4, 'europa');
                this.createMoon(this.planets.get('jupiter'), 0.14, 3.0, 0x45b7d1, 'ganymede');
                this.createMoon(this.planets.get('jupiter'), 0.13, 3.5, 0x96ceb4, 'callisto');
                this.createMoon(this.planets.get('saturn'), 0.11, 2.2, 0xf9a825, 'titan');
                
                // Anneaux de Saturne
                this.createSaturnRings();
            }

            createPlanet(config) {
                const geometry = new THREE.SphereGeometry(config.radius, 32, 32);
                
                let material;
                if (config.emissive) {
                    material = new THREE.MeshPhongMaterial({ 
                        color: 0xff6600,
                        emissive: 0xff3300,
                        emissiveIntensity: 1.0,
                        shininess: 5,
                        specular: 0xff8800
                    });
                } else {
                    material = new THREE.MeshPhongMaterial({ 
                        color: config.color,
                        shininess: 30
                    });
                }

                const planet = new THREE.Mesh(geometry, material);
                planet.name = config.name;

                // Groupe pour la r√©volution
                const planetGroup = new THREE.Group();
                planetGroup.name = `${config.name}Group`;
                planetGroup.add(planet);
                
                // Positionner la plan√®te
                planet.position.x = config.distance;

                // Stocker les donn√©es de la plan√®te
                planet.userData = {
                    type: 'planet',
                    radius: config.radius,
                    distance: config.distance,
                    rotationSpeed: config.rotationSpeed,
                    revolutionSpeed: config.revolutionSpeed,
                    color: config.color,
                    info: this.getPlanetInfo(config.name)
                };

                // Cr√©er l'orbite visible
                this.createOrbit(config.distance, config.name);

                this.scene.add(planetGroup);
                
                this.planets.set(config.name, planet);
                this.planetGroups.set(config.name, planetGroup);
            }

            createOrbit(distance, name) {
                const orbitGeometry = new THREE.RingGeometry(distance - 0.05, distance + 0.05, 64);
                const orbitMaterial = new THREE.MeshBasicMaterial({ 
                    color: 0xffffff, 
                    side: THREE.DoubleSide,
                    transparent: true,
                    opacity: 0.1
                });
                const orbit = new THREE.Mesh(orbitGeometry, orbitMaterial);
                orbit.rotation.x = Math.PI / 2;
                orbit.name = `${name}Orbit`;
                this.scene.add(orbit);
            }

            createMoon(planet, radius, distance, color, name) {
                const geometry = new THREE.SphereGeometry(radius, 16, 16);
                const material = new THREE.MeshPhongMaterial({ 
                    color: color
                });
                const moon = new THREE.Mesh(geometry, material);
                moon.name = name;
                moon.position.x = distance;
                moon.castShadow = true;
                
                // Rendre la lune cliquable et l'ajouter √† la Map
                moon.userData = {
                    type: 'moon',
                    parent: planet.name,
                    radius: radius,
                    distance: distance,
                    color: color,
                    rotationSpeed: 0.005,
                    revolutionSpeed: 0.02,
                    info: this.getPlanetInfo(name)
                };

                planet.add(moon);
                this.planets.set(name, moon); // Ajouter aux objets cliquables
                
                return moon;
            }

            createSaturnRings() {
                const saturn = this.planets.get('saturn');
                if (!saturn) return;

                const ringGeometry = new THREE.RingGeometry(1.8, 3.0, 32);
                const ringMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0xf0e6d2, 
                    side: THREE.DoubleSide,
                    transparent: true,
                    opacity: 0.7
                });
                const rings = new THREE.Mesh(ringGeometry, ringMaterial);
                rings.rotation.x = Math.PI / 2;
                rings.name = "saturnRings";
                saturn.add(rings);
            }

            createStars() {
                const starsGeometry = new THREE.BufferGeometry();
                const starsMaterial = new THREE.PointsMaterial({
                    color: 0xffffff,
                    size: 0.7,
                    sizeAttenuation: true
                });

                const starsVertices = [];
                for (let i = 0; i < 2000; i++) {
                    const x = (Math.random() - 0.5) * 2000;
                    const y = (Math.random() - 0.5) * 2000;
                    const z = (Math.random() - 0.5) * 2000;
                    starsVertices.push(x, y, z);
                }

                starsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starsVertices, 3));
                const stars = new THREE.Points(starsGeometry, starsMaterial);
                this.scene.add(stars);
            }

            getPlanetInfo(planetName) {
                const info = {
                    sun: `
                        <span class="highlight">‚òÖ SOLEIL ‚òÖ</span><br>
                        <strong>Type:</strong> √âtoile (naine jaune G2V)<br>
                        <strong>Diam√®tre:</strong> 1 392 684 km (109 Terres)<br>
                        <strong>Masse:</strong> 1,989 √ó 10¬≥‚Å∞ kg (333 000 Terres)<br>
                        <strong>Temp√©rature:</strong> 5 500¬∞C (surface) - 15 000 000¬∞C (noyau)<br>
                        <strong>√Çge:</strong> 4,6 milliards d'ann√©es<br>
                        <strong>Composition:</strong> 74% hydrog√®ne, 24% h√©lium, 2% √©l√©ments lourds<br>
                        <strong>Gravit√© de surface:</strong> 274 m/s¬≤ (28√ó la Terre)<br>
                        <strong>Particularit√©:</strong> Repr√©sente 99,86% de la masse du syst√®me solaire
                    `,
                    
                    mercury: `
                        <span class="highlight">‚òø MERCURE ‚òø</span><br>
                        <strong>Type:</strong> Plan√®te tellurique<br>
                        <strong>Diam√®tre:</strong> 4 879 km (0,38√ó Terre)<br>
                        <strong>Distance du Soleil:</strong> 57,9 millions de km (0,39 UA)<br>
                        <strong>P√©riode orbitale:</strong> 88 jours terrestres<br>
                        <strong>Rotation:</strong> 59 jours terrestres<br>
                        <strong>Temp√©rature:</strong> -173¬∞C √† 427¬∞C<br>
                        <strong>Atmosph√®re:</strong> Tr√®s t√©nue (oxyg√®ne, sodium, hydrog√®ne)<br>
                        <strong>Satellites:</strong> Aucune<br>
                        <strong>Gravit√©:</strong> 3,7 m/s¬≤ (0,38√ó Terre)<br>
                        <strong>Particularit√©:</strong> Plus petite plan√®te et plus grande variation thermique
                    `,
                    
                    venus: `
                        <span class="highlight">‚ôÄ V√âNUS ‚ôÄ</span><br>
                        <strong>Type:</strong> Plan√®te tellurique<br>
                        <strong>Diam√®tre:</strong> 12 104 km (0,95√ó Terre)<br>
                        <strong>Distance du Soleil:</strong> 108,2 millions de km (0,72 UA)<br>
                        <strong>P√©riode orbitale:</strong> 225 jours terrestres<br>
                        <strong>Rotation:</strong> 243 jours terrestres (r√©trograde)<br>
                        <strong>Temp√©rature:</strong> 462¬∞C en moyenne<br>
                        <strong>Atmosph√®re:</strong> Dense (96% CO‚ÇÇ, pression 92√ó Terre)<br>
                        <strong>Satellites:</strong> Aucune<br>
                        <strong>Gravit√©:</strong> 8,87 m/s¬≤ (0,91√ó Terre)<br>
                        <strong>Particularit√©:</strong> Effet de serre extr√™me - jour plus long que l'ann√©e
                    `,
                    
                    earth: `
                        <span class="highlight">‚ôÅ TERRE ‚ôÅ</span><br>
                        <strong>Type:</strong> Plan√®te tellurique<br>
                        <strong>Diam√®tre:</strong> 12 742 km<br>
                        <strong>Distance du Soleil:</strong> 149,6 millions de km (1 UA)<br>
                        <strong>P√©riode orbitale:</strong> 365,25 jours<br>
                        <strong>Rotation:</strong> 23h 56min 4s<br>
                        <strong>Temp√©rature:</strong> -88¬∞C √† 58¬∞C (moyenne 15¬∞C)<br>
                        <strong>Atmosph√®re:</strong> 78% N‚ÇÇ, 21% O‚ÇÇ, 1% Ar<br>
                        <strong>Satellites:</strong> 1 (La Lune)<br>
                        <strong>Gravit√©:</strong> 9,81 m/s¬≤<br>
                        <strong>Particularit√©:</strong> Seule plan√®te avec de l'eau liquide et la vie
                    `,
                    
                    mars: `
                        <span class="highlight">‚ôÇ MARS ‚ôÇ</span><br>
                        <strong>Type:</strong> Plan√®te tellurique<br>
                        <strong>Diam√®tre:</strong> 6 779 km (0,53√ó Terre)<br>
                        <strong>Distance du Soleil:</strong> 227,9 millions de km (1,52 UA)<br>
                        <strong>P√©riode orbitale:</strong> 687 jours terrestres<br>
                        <strong>Rotation:</strong> 24h 37min 23s<br>
                        <strong>Temp√©rature:</strong> -87¬∞C √† -5¬∞C (moyenne -65¬∞C)<br>
                        <strong>Atmosph√®re:</strong> T√©nue (95% CO‚ÇÇ, pression 0,6% Terre)<br>
                        <strong>Satellites:</strong> 2 (Phobos et Deimos)<br>
                        <strong>Gravit√©:</strong> 3,71 m/s¬≤ (0,38√ó Terre)<br>
                        <strong>Particularit√©:</strong> Olympus Mons : plus grand volcan (25 km)
                    `,
                    
                    jupiter: `
                        <span class="highlight">‚ôÉ JUPITER ‚ôÉ</span><br>
                        <strong>Type:</strong> G√©ante gazeuse<br>
                        <strong>Diam√®tre:</strong> 139 820 km (11,2√ó Terre)<br>
                        <strong>Distance du Soleil:</strong> 778,5 millions de km (5,2 UA)<br>
                        <strong>P√©riode orbitale:</strong> 11,9 ann√©es terrestres<br>
                        <strong>Rotation:</strong> 9h 56min (la plus rapide)<br>
                        <strong>Temp√©rature:</strong> -108¬∞C en moyenne<br>
                        <strong>Atmosph√®re:</strong> 90% H‚ÇÇ, 10% He (avec bandes nuageuses)<br>
                        <strong>Satellites:</strong> 95 connus (dont Europe, Ganym√®de, Io, Callisto)<br>
                        <strong>Anneaux:</strong> Oui (discrets)<br>
                        <strong>Particularit√©:</strong> Plus grande plan√®te - Grande Tache Rouge (temp√™te g√©ante)
                    `,
                    
                    saturn: `
                        <span class="highlight">‚ôÑ SATURNE ‚ôÑ</span><br>
                        <strong>Type:</strong> G√©ante gazeuse<br>
                        <strong>Diam√®tre:</strong> 116 460 km (9,45√ó Terre)<br>
                        <strong>Distance du Soleil:</strong> 1,43 milliard de km (9,58 UA)<br>
                        <strong>P√©riode orbitale:</strong> 29,5 ann√©es terrestres<br>
                        <strong>Rotation:</strong> 10h 42min<br>
                        <strong>Temp√©rature:</strong> -138¬∞C en moyenne<br>
                        <strong>Atmosph√®re:</strong> 96% H‚ÇÇ, 3% He<br>
                        <strong>Satellites:</strong> 146 connus (dont Titan, Encelade)<br>
                        <strong>Anneaux:</strong> Oui (syst√®me majeur de glace et poussi√®re)<br>
                        <strong>Particularit√©:</strong> Densit√© inf√©rieure √† l'eau - anneaux spectaculaires
                    `,
                    
                    uranus: `
                        <span class="highlight">‚ôÖ URANUS ‚ôÖ</span><br>
                        <strong>Type:</strong> G√©ante de glace<br>
                        <strong>Diam√®tre:</strong> 50 724 km (4,01√ó Terre)<br>
                        <strong>Distance du Soleil:</strong> 2,87 milliards de km (19,2 UA)<br>
                        <strong>P√©riode orbitale:</strong> 84 ann√©es terrestres<br>
                        <strong>Rotation:</strong> 17h 14min (r√©trograde, inclin√© √† 98¬∞)<br>
                        <strong>Temp√©rature:</strong> -197¬∞C en moyenne<br>
                        <strong>Atmosph√®re:</strong> 83% H‚ÇÇ, 15% He, 2% CH‚ÇÑ (m√©thane)<br>
                        <strong>Satellites:</strong> 27 connus (dont Titania, Ob√©ron)<br>
                        <strong>Anneaux:</strong> Oui (sombres et fins)<br>
                        <strong>Particularit√©:</strong> Rotation sur le c√¥t√© - couleur bleu-vert du m√©thane
                    `,
                    
                    neptune: `
                        <span class="highlight">‚ôÜ NEPTUNE ‚ôÜ</span><br>
                        <strong>Type:</strong> G√©ante de glace<br>
                        <strong>Diam√®tre:</strong> 49 244 km (3,88√ó Terre)<br>
                        <strong>Distance du Soleil:</strong> 4,5 milliards de km (30,1 UA)<br>
                        <strong>P√©riode orbitale:</strong> 165 ann√©es terrestres<br>
                        <strong>Rotation:</strong> 16h 6min<br>
                        <strong>Temp√©rature:</strong> -201¬∞C en moyenne<br>
                        <strong>Atmosph√®re:</strong> 80% H‚ÇÇ, 19% He, 1% CH‚ÇÑ<br>
                        <strong>Satellites:</strong> 14 connus (dont Triton)<br>
                        <strong>Anneaux:</strong> Oui (au moins 5 anneaux)<br>
                        <strong>Particularit√©:</strong> Vents les plus rapides (2 100 km/h) - Grande Tache Sombre
                    `,
                    
                    moon: `
                        <span class="highlight">üåô LA LUNE üåô</span><br>
                        <strong>Type:</strong> Satellite naturel<br>
                        <strong>Diam√®tre:</strong> 3 474 km (0,27√ó Terre)<br>
                        <strong>Distance de la Terre:</strong> 384 400 km<br>
                        <strong>P√©riode orbitale:</strong> 27,3 jours<br>
                        <strong>Rotation:</strong> 27,3 jours (rotation synchrone)<br>
                        <strong>Temp√©rature:</strong> -173¬∞C √† 127¬∞C<br>
                        <strong>Atmosph√®re:</strong> Tr√®s t√©nue (exosph√®re)<br>
                        <strong>Gravit√©:</strong> 1,62 m/s¬≤ (1/6 de la Terre)<br>
                        <strong>Particularit√©:</strong> Seul astre visit√© par l'homme - influence les mar√©es
                    `,
                    
                    phobos: `
                        <span class="highlight">ü™ê PHOBOS</span><br>
                        <strong>Type:</strong> Satellite de Mars<br>
                        <strong>Diam√®tre:</strong> 22,2 km<br>
                        <strong>Distance de Mars:</strong> 9 377 km<br>
                        <strong>P√©riode orbitale:</strong> 7h 39min<br>
                        <strong>Forme:</strong> Irr√©guli√®re (27 √ó 22 √ó 18 km)<br>
                        <strong>Composition:</strong> Rocheux, riche en carbone<br>
                        <strong>Gravit√©:</strong> 0,0057 m/s¬≤ (tr√®s faible)<br>
                        <strong>Particularit√©:</strong> Se rapproche de Mars de 1,8 cm par an - impact futur
                    `,
                    
                    deimos: `
                        <span class="highlight">ü™ê DEIMOS</span><br>
                        <strong>Type:</strong> Satellite de Mars<br>
                        <strong>Diam√®tre:</strong> 12,4 km<br>
                        <strong>Distance de Mars:</strong> 23 460 km<br>
                        <strong>P√©riode orbitale:</strong> 30h 18min<br>
                        <strong>Forme:</strong> Irr√©guli√®re (15 √ó 12 √ó 11 km)<br>
                        <strong>Composition:</strong> Rocheux, similaire aux ast√©ro√Ødes<br>
                        <strong>Gravit√©:</strong> 0,003 m/s¬≤ (tr√®s faible)<br>
                        <strong>Particularit√©:</strong> Surface lisse - √©jecta comblant les crat√®res
                    `,
                    
                    io: `
                        <span class="highlight">ü™ê IO</span><br>
                        <strong>Type:</strong> Satellite de Jupiter<br>
                        <strong>Diam√®tre:</strong> 3 643 km<br>
                        <strong>Distance de Jupiter:</strong> 421 700 km<br>
                        <strong>P√©riode orbitale:</strong> 1,77 jours terrestres<br>
                        <strong>Particularit√©:</strong> Corps le plus volcanique du syst√®me solaire
                    `,

                    europa: `
                        <span class="highlight">ü™ê EUROPA</span><br>
                        <strong>Type:</strong> Satellite de Jupiter<br>
                        <strong>Diam√®tre:</strong> 3 122 km<br>
                        <strong>Distance de Jupiter:</strong> 671 034 km<br>
                        <strong>P√©riode orbitale:</strong> 3,55 jours terrestres<br>
                        <strong>Particularit√©:</strong> Oc√©an souterrain potentiellement habitable
                    `,

                    ganymede: `
                        <span class="highlight">ü™ê GANYMEDE</span><br>
                        <strong>Type:</strong> Satellite de Jupiter<br>
                        <strong>Diam√®tre:</strong> 5 268 km<br>
                        <strong>Distance de Jupiter:</strong> 1 070 400 km<br>
                        <strong>P√©riode orbitale:</strong> 7,15 jours terrestres<br>
                        <strong>Particularit√©:</strong> Plus grand satellite du syst√®me solaire
                    `,

                    callisto: `
                        <span class="highlight">ü™ê CALLISTO</span><br>
                        <strong>Type:</strong> Satellite de Jupiter<br>
                        <strong>Diam√®tre:</strong> 4 821 km<br>
                        <strong>Distance de Jupiter:</strong> 1 882 700 km<br>
                        <strong>P√©riode orbitale:</strong> 16,69 jours terrestres<br>
                        <strong>Particularit√©:</strong> Surface tr√®s crat√©ris√©e, ancienne
                    `,

                    titan: `
                        <span class="highlight">ü™ê TITAN</span><br>
                        <strong>Type:</strong> Satellite de Saturne<br>
                        <strong>Diam√®tre:</strong> 5 151 km<br>
                        <strong>Distance de Saturne:</strong> 1 221 870 km<br>
                        <strong>P√©riode orbitale:</strong> 15,95 jours terrestres<br>
                        <strong>Particularit√©:</strong> Seul satellite avec une atmosph√®re dense
                    `
                };
                return info[planetName] || "Corps c√©leste myst√©rieux du syst√®me solaire.";
            }

            setupEventListeners() {
                // Redimensionnement
                window.addEventListener('resize', () => this.onWindowResize());
                
                // Clic sur les plan√®tes
                this.raycaster = new THREE.Raycaster();
                this.mouse = new THREE.Vector2();
                
                this.renderer.domElement.addEventListener('click', (event) => this.onPlanetClick(event));
                this.renderer.domElement.style.cursor = 'grab';
                
                // Contr√¥les UI
                const speedSlider = document.getElementById('speed-slider');
                const speedValue = document.getElementById('speed-value');
                const scaleSlider = document.getElementById('scale-slider');
                const scaleValue = document.getElementById('scale-value');

                speedSlider.addEventListener('input', (e) => {
                    this.animationSpeed = parseFloat(e.target.value);
                    speedValue.textContent = this.animationSpeed.toFixed(1) + 'x';
                });

                scaleSlider.addEventListener('input', (e) => {
                    this.scaleFactor = parseFloat(e.target.value);
                    scaleValue.textContent = this.scaleFactor.toFixed(1) + 'x';
                    this.updatePlanetScales();
                });
            }

            updatePlanetScales() {
                this.planets.forEach((planet, name) => {
                    if (name !== 'sun') {
                        planet.scale.setScalar(this.scaleFactor);
                    }
                });
            }

            onPlanetClick(event) {
                // Calculer la position de la souris
                const rect = this.renderer.domElement.getBoundingClientRect();
                this.mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                this.mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;

                // Mettre √† jour le raycaster
                this.raycaster.setFromCamera(this.mouse, this.camera);

                // Cr√©er un tableau avec TOUS les objets cliquables
                const allClickableObjects = Array.from(this.planets.values());
                
                // V√©rifier et ajouter les lunes qui pourraient manquer
                this.planets.forEach(planet => {
                    planet.children.forEach(child => {
                        if (child.userData && child.userData.type === 'moon' && !allClickableObjects.includes(child)) {
                            allClickableObjects.push(child);
                        }
                    });
                });

                const intersects = this.raycaster.intersectObjects(allClickableObjects);

                if (intersects.length > 0) {
                    const celestialBody = intersects[0].object;
                    this.selectPlanet(celestialBody);
                }
            }

            selectPlanet(celestialBody) {
                // R√©initialiser la s√©lection pr√©c√©dente
                if (this.selectedPlanet) {
                    if (this.selectedPlanet.name === 'sun') {
                        this.selectedPlanet.material.emissiveIntensity = 0.8;
                    } else if (this.selectedPlanet.userData.originalColor) {
                        this.selectedPlanet.material.color.copy(this.selectedPlanet.userData.originalColor);
                        if (this.selectedPlanet.material.emissive) {
                            this.selectedPlanet.material.emissive.set(0x000000);
                        }
                    }
                }

                // S√©lectionner le nouveau corps c√©leste
                this.selectedPlanet = celestialBody;
                
                if (celestialBody.name === 'sun') {
                    celestialBody.material.emissiveIntensity = 1.5;
                } else {
                    if (!celestialBody.userData.originalColor) {
                        celestialBody.userData.originalColor = celestialBody.material.color.clone();
                    }
                    
                    const intensifiedColor = celestialBody.userData.originalColor.clone();
                    intensifiedColor.offsetHSL(0, 0.3, 0.2);
                    celestialBody.material.color.copy(intensifiedColor);
                    
                    if (celestialBody.material.emissive) {
                        celestialBody.material.emissive = celestialBody.userData.originalColor.clone().multiplyScalar(0.3);
                    }
                }

                // Afficher les informations
                this.showPlanetInfo(celestialBody.name, celestialBody.userData.info);
            }

            showPlanetInfo(name, info) {
                const planetInfo = document.getElementById('planetInfo');
                const displayName = name.charAt(0).toUpperCase() + name.slice(1);
                
                const celestialBody = this.planets.get(name);
                const radius = celestialBody ? celestialBody.userData.radius : 'N/A';
                const distance = celestialBody ? celestialBody.userData.distance : 'N/A';
                
                planetInfo.innerHTML = `
                    <h3>${name === 'sun' ? '‚òÄÔ∏è' : 'ü™ê'} ${displayName}</h3>
                    <div>${info}</div>
                    <p style="margin-top: 10px; color: #ffcc80;">
                        Rayon: ${radius} unit√©s | Distance: ${distance} unit√©s
                    </p>
                `;
            }

            onWindowResize() {
                this.camera.aspect = window.innerWidth / window.innerHeight;
                this.camera.updateProjectionMatrix();
                this.renderer.setSize(window.innerWidth, window.innerHeight);
            }

            hideLoading() {
                document.getElementById('loading').style.display = 'none';
            }

            animate() {
                requestAnimationFrame(() => this.animate());

                // Animer les plan√®tes ET les lunes
                this.planets.forEach((celestialBody, name) => {
                    const data = celestialBody.userData;
                    
                    if (data.type === 'moon') {
                        // Animation des lunes
                        celestialBody.rotation.y += data.rotationSpeed * this.animationSpeed;
                    } else {
                        // Animation des plan√®tes
                        celestialBody.rotation.y += data.rotationSpeed * this.animationSpeed;
                        
                        // R√©volution autour du soleil
                        const group = this.planetGroups.get(name);
                        if (group && data.revolutionSpeed > 0) {
                            group.rotation.y += data.revolutionSpeed * this.animationSpeed;
                        }
                    }
                });

                // Mettre √† jour les contr√¥les
                if (this.controls) {
                    this.controls.update();
                }

                this.renderer.render(this.scene, this.camera);
            }
        }

        // D√©marrer l'application quand la page est charg√©e
        window.addEventListener('DOMContentLoaded', () => {
            new SolarSystem();
        });

        // Gestion des erreurs
        window.addEventListener('error', (e) => {
            console.error('Erreur:', e.error);
            document.getElementById('loading').textContent = 'Erreur de chargement. Veuillez rafra√Æchir la page.';
        });
    </script>
</body>
</html>